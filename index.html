<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <title>SÃ¼rpriz Puzzle</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        body { margin: 0; background: black; color: white; font-family: sans-serif; text-align: center; }
        #puzzle {
            display: grid;
            margin: 10px auto;
            grid-template-columns: repeat(5, 64px);
            grid-gap: 2px;
            touch-action: none;
            width: max-content;
        }
        .piece {
            width: 64px;
            height: 64px;
            cursor: grab;
            touch-action: none;
            user-select: none;
        }
        @media (min-width: 600px) {
            #puzzle {
                grid-template-columns: repeat(5, 96px);
                grid-gap: 3px;
            }
            .piece {
                width: 96px;
                height: 96px;
            }
        }
        #message { display: none; margin-top: 20px; font-size: 1.2em; color: #ffcccc; }
        #shuffleButton {
            margin: 15px auto;
            padding: 10px 20px;
            background: #444;
            border: none;
            color: white;
            font-size: 1.1em;
            cursor: pointer;
            border-radius: 6px;
        }
    </style>
</head>
<body>
    <h2>ðŸ§© Puzzle'Ä± Tamamla</h2>
    <button id="shuffleButton">Puzzle'Ä± KarÄ±ÅŸtÄ±r ve Ã‡Ã¶zmeye BaÅŸla</button>
    <div id="puzzle"></div>
    <div id="message">ðŸ’Œ BebeÄŸim senden Ã§ok Ã¶zÃ¼r dilerim umarÄ±m bu bir nebze olsun hatamÄ± telafi etmiÅŸtir...</div>

<script>
    const size = 5;
    const container = document.getElementById('puzzle');
    const shuffleButton = document.getElementById('shuffleButton');

    // Puzzle parÃ§alarÄ±nÄ± satÄ±r ve sÃ¼tun bilgisiyle oluÅŸtur
    let pieces = [];
    for (let row = 0; row < size; row++) {
        for (let col = 0; col < size; col++) {
            pieces.push({ row, col, src: `img/piece_${row}_${col}.png` });
        }
    }

    // Puzzle'Ä± dÃ¼zgÃ¼n sÄ±ralÄ± ÅŸekilde Ã§iz
    function renderPieces(arr) {
        container.innerHTML = '';
        arr.forEach(({ src }, index) => {
            const img = document.createElement('img');
            img.src = src;
            img.className = 'piece';
            img.draggable = true;
            img.dataset.index = index;
            container.appendChild(img);
        });
    }

    // BaÅŸlangÄ±Ã§ta dÃ¼zgÃ¼n sÄ±rayla yÃ¼kle (bileÅŸik)
    renderPieces(pieces);

    // KarÄ±ÅŸtÄ±rma fonksiyonu (Fisher-Yates)
    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    let dragSrcEl = null;

    // Drag & Drop eventlerini ayarla
    function enableDragAndDrop() {
        container.addEventListener('dragstart', e => {
            if (!e.target.classList.contains('piece')) return;
            dragSrcEl = e.target;
        });

        container.addEventListener('dragover', e => {
            e.preventDefault();
        });

        container.addEventListener('drop', e => {
            e.preventDefault();
            if (!e.target.classList.contains('piece')) return;
            if (dragSrcEl === e.target) return;

            const children = Array.from(container.children);
            const dragIndex = children.indexOf(dragSrcEl);
            const dropIndex = children.indexOf(e.target);

            container.insertBefore(dragSrcEl, e.target);
            if (dropIndex < dragIndex) {
                container.insertBefore(e.target, children[dragIndex]);
            } else {
                container.insertBefore(e.target, dragSrcEl.nextSibling);
            }

            checkSolved();
        });
    }

    // Puzzle Ã§Ã¶zÃ¼mÃ¼nÃ¼ kontrol et
    function checkSolved() {
        const current = [...container.children];
        // Orijinal sÄ±ralÄ± hal
        const correct = [...current].slice().sort((a, b) => a.src.localeCompare(b.src));
        const isSolved = current.every((el, i) => el.src === correct[i].src);
        if (isSolved) {
            document.getElementById('message').style.display = 'block';
            shuffleButton.style.display = 'none';
        }
    }

    // Butona tÄ±klayÄ±nca puzzle karÄ±ÅŸsÄ±n ve drag-drop aktif olsun
    shuffleButton.addEventListener('click', () => {
        shuffle(pieces);
        renderPieces(pieces);
        enableDragAndDrop();
        shuffleButton.style.display = 'none';
    });
</script>
</body>
</html>
